#!/bin/bash

iptables -A INPUT -s 10.0.1.5 -j DROP
iptables -A INPUT -s 31.13.74.0/24 -j DROP
iptables -n -L INPUT
# Chain INPUT (policy ACCEPT)
# target	prot opt source		destination
# DROP		all -- 10.0.1.5		0.0.0.0/0
# DROP		all -- 31.13.74.0/24	0.0.0.0/0

iptables -A INPUT -m state --state NEW -p tcp --dport 22 -j ACCEPT
iptables -A INPUT -m state --state NEW -p tcp --dport 80 -j ACCEPT
iptables -A INPUT -m state --state NEW -p tcp --dport 143 -j ACCEPT
# Chain INPUT (policy ACCEPT)
# target	prot opt source		destination
# DROP		all -- 10.0.1.5		0.0.0.0/0
# DROP		all -- 31.13.74.0/24	0.0.0.0/0
# ACCEPT	tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:22
# ACCEPT	tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:80
# ACCEPT	tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:143

iptables -n -L INPUT --line-numbers
# Chain INPUT (policy ACCEPT)
# num		target		prot opt source		destination
# 1		DROP 		all -- 10.0.1.5		0.0.0.0/0
# 2		DROP		all -- 31.13.74.0/24	0.0.0.0/0
# 3		ACCEPT		tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:22
# 4		ACCEPT		tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:80
# 5		ACCEPT		tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:143

iptables -D INPUT 2
iptables -D INPUT 1
iptables -n -L INPUT --line-numbers
# Chain INPUT (policy ACCEPT)
# num		target		prot opt source		destination
# 1		ACCEPT		tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:22
# 2		ACCEPT		tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:80
# 3		ACCEPt		tcp -- 0.0.0.0/0	0.0.0.0/0	state NEW tcp dpt:143
